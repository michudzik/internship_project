<% if @ticket.errors.any? %>
  <div class="container">
    <div class="row">
      <div class="col-md-6 offset-md-3 alert alert-danger">
        <h5><%= pluralize(@ticket.errors.count, 'error') %> prohibited this ticket from being saved</h5>
        <ul>
        <% @ticket.errors.full_messages.each do |msg| %>
          <li>
            <%= msg %>
          </li>
        <% end %>
        </ul>
      </div>
    </div>
  </div>
<% end %>

<div class="container">
  <div class="row">
    <div class="col-md-6 offset-md-3">
      <h1><center> Create new ticket </center></h1> 
      <%= form_for @ticket, id: "myForm", url: user_tickets_path(current_user.id) do |f| %>
        <%= f.label :department_id %>
        <%= f.select :department_id, @departments, {}, class: 'custom-select' %>
        <hr />
        <%= f.label :title %>
        <%= f.text_field :title, class: 'form-control' %>
        <hr />
        <%= f.label :note , 'Body' %>
        <%= f.text_area :note, class: 'form-control', cols: '16', rows: '6' %>
        <hr />
        <%= f.label :uploads , 'Attachments' %><br/>
        <%= f.file_field :uploads, class: 'form-control', multiple: true, class: 'btn btn-default' %>
        <hr />
        <%= f.submit 'Create', class: 'btn btn-primary' %>
      <% end %>
    </div>
  </div>
</div>

<script>

  $(document).on('turbolinks:load', function(){
    var form = $('#new_ticket'),
       original = form.serialize()

    form.submit(function(){
       window.onbeforeunload = null
    })

    window.onbeforeunload = function(){
       if (form.serialize() != original)
           return 'Are you sure you want to leave?'
    }
  })

  var turboalert = function(e){

    if(confirm('are u sure?')) {
      
    }
    else {
      e.preventDefault();
    }
    $(document).off('turbolinks:before-visit');
    $(document).off(turboalert);
  }

  $(document).on('turbolinks:before-visit', turboalert)
</script>